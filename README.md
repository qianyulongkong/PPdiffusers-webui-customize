# ğŸ‘¾äºŒæ¬¡å…ƒè§’è‰²é£æ ¼å®šåˆ¶âœ¨ğŸ‘¾

äºŒæ¬¡å…ƒè§’è‰²é£æ ¼å®šåˆ¶æ˜¯ä¸€æ¬¾åŸºäºPaddleæ¡†æ¶å®ç°çš„æ·±åº¦å­¦ä¹ æ¨¡å‹å·¥å…·ã€‚ç”¨æˆ·ä»…éœ€è¦è¾“å…¥æç¤ºè¯æˆ–é¢å¤–æä¾›ä¸€å¼ ç…§ç‰‡å³å¯è·å¾—æŸä¸€è§’è‰²å¯¹åº”é£æ ¼çš„å›¾ç‰‡ã€‚

å¦‚æœä¸æ»¡äºç°æœ‰å†…ç½®çš„è§’è‰²å’Œé£æ ¼ï¼Œä¹Ÿå¯ä»¥è¾“å…¥10-30å¼ å›¾ç‰‡è®­ç»ƒè‡ªå·±çš„è§’è‰²ã€é£æ ¼Loraï¼Œè¿›è¡Œç»„åˆä½¿ç”¨ã€‚

å¦‚æœä»…ä»…æƒ³ä½“éªŒä¸€ä¸‹è¯¥é¡¹ç›®çš„æ•ˆæœï¼Œåªéœ€è¦çœ‹å®Œåº”ç”¨ç¯‡å°±å¯ä»¥è½»æ¾ä½¿ç”¨ã€‚æƒ³è¦å®Œæ•´å­¦ä¹ æœ¬é¡¹ç›®ï¼Œè¯·é˜…è§ˆè¿›é˜¶ç¯‡ã€‚åœ¨è¿›é˜¶ç¯‡ï¼Œä½ å°†ç†Ÿæ‚‰PPdiffusersçš„ä½¿ç”¨ã€æ–‡ç”Ÿå›¾ã€å›¾ç”Ÿå›¾çš„é¡¹ç›®ç»“æ„ä»¥åŠLoraçš„è®­ç»ƒä¸åº”ç”¨ç­‰ç­‰ã€‚

æœ‰ä»€ä¹ˆé—®é¢˜å¯ä»¥åœ¨è¯„è®ºåŒºæå‡ºï¼Œæˆ‘ä¼šå°½åŠ›å›ç­”ã€‚æœŸå¾…ä½ æœ‰æ‰€æ”¶è·ã€‚


# ä¸€ã€åº”ç”¨ç¯‡

## 1.æ‹‰å–ä»£ç ä»“åº“

æ‹‰å–githubä¸Šå¯èƒ½å› ä¸ºç½‘ç»œåŸå› å¯¼è‡´å¤±è´¥ï¼Œæˆ‘ä»¬å¯ä»¥æ‹‰å–giteeä¸Šçš„ä»“åº“ã€‚giteeä¸githubä»“åº“ä¿æŒåŒæ­¥æ›´æ–°ã€‚


```python
# å…‹éš†giteeä¸Šä»£ç ï¼Œ-bè¡¨ç¤ºç‰¹å®šåˆ†æ”¯ï¼Œæˆ‘ä»¬é€‰æ‹©ppdiffusersåˆ†æ”¯
!git clone -b ppdiffusers 

"""# å…‹éš†githubä¸Šä»£ç ï¼Œ-bè¡¨ç¤ºç‰¹å®šåˆ†æ”¯ï¼Œæˆ‘ä»¬é€‰æ‹©ppdiffusersåˆ†æ”¯
!git clone -b ppdiffusers 
```

    æ­£å…‹éš†åˆ° 'PPdiffusers-webui'...
    remote: Enumerating objects: 2249, done.[K
    remote: Counting objects: 100% (2249/2249), done.[K
    remote: Compressing objects: 100% (1407/1407), done.[K
    remote: Total 2249 (delta 1322), reused 1732 (delta 808), pack-reused 0[K
    æ¥æ”¶å¯¹è±¡ä¸­: 100% (2249/2249), 10.03 MiB | 2.32 MiB/s, å®Œæˆ.
    å¤„ç† delta ä¸­: 100% (1322/1322), å®Œæˆ.
    æ£€æŸ¥è¿æ¥... å®Œæˆã€‚





    '# å…‹éš†githubä¸Šä»£ç ï¼Œ-bè¡¨ç¤ºç‰¹å®šåˆ†æ”¯ï¼Œæˆ‘ä»¬é€‰æ‹©ppdiffusersåˆ†æ”¯\n!git clone -b ppdiffusers https://github.com/tensorfly-gpu/PPdiffusers-webui'



## 2.è§£å‹æ¨¡å‹æ–‡ä»¶

è§£å‹Anything-v5.0æ¨¡å‹ã€‚ä¹Ÿå¯é€‰æ‹©ä¸‹è½½æ¨¡å‹æ–‡ä»¶ï¼Œå°†æ–°æ¨¡å‹æ”¾åœ¨modelsæ–‡ä»¶å¤¹ä¸‹ï¼Œå¹¶å°†åç§°åŠ å…¥utils.pyä¸­çš„model_name_listå³å¯ã€‚

model_name_list = ["Anything-v5.0", 
            "æ–°æ¨¡å‹æ–‡ä»¶å¤¹åç§°"
            ]


```python
!unzip data/data*/Anything-v5.0.zip -d PPdiffusers-webui/models
```

## 3.è¿è¡Œlaunch.pyé…ç½®ç¯å¢ƒ

è¿è¡Œlaunch.pyé…ç½®ç¯å¢ƒï¼Œé…ç½®å®Œä¹‹åï¼Œé‡å¯å†…æ ¸ã€‚

**è¿è¡Œä»¥ä¸‹ä»£ç ï¼Œç„¶åé‡å¯å†…æ ¸å³å¯**


```python
%cd /home/aistudio/PPdiffusers-webui
!python launch.py
```

## 4.è¿›å…¥UIç•Œé¢

è¿›å…¥UIç•Œé¢ã€‚åŒå‡» PPdiffusers-webui/launch.gradio.py æ–‡ä»¶ã€‚

åœ¨å³è¾¹å‡ºç°UIç•Œé¢åï¼Œç‚¹å‡»ä¸‹å›¾ä¸­çº¢æ¡†ä½ç½®ï¼Œå³å¯ä½¿ç”¨ç½‘é¡µè¿›è¡Œæ‰“å¼€ã€‚ç„¶åå°±å¯ä»¥è¿›è¡ŒAIç»˜ç”»äº†ï¼

![](https://ai-studio-static-online.cdn.bcebos.com/c00d41e0ab7d4ababacdd8728f56271f33c2058d71514927b00c2fccc7024d3a)


# äºŒã€è¿›é˜¶ç¯‡

## 1ã€é¡¹ç›®ç»“æ„

äºŒæ¬¡å…ƒè§’è‰²é£æ ¼å®šåˆ¶é¡¹ç›®ä¸»è¦åˆ†ä¸ºå‰ç«¯å’Œåç«¯ä¸¤ä¸ªç»“æ„ï¼š

**å‰ç«¯éƒ¨åˆ†ï¼š**ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“Gradioæ„å»ºå‰ç«¯ç•Œé¢ï¼Œå¹¶ä¸»è¦ä½¿ç”¨æŒ‰é’®ï¼ˆGradio.buttonï¼‰çš„clickå‡½æ•°ä¸åç«¯è¿›è¡Œè¿æ¥ã€‚

**åç«¯éƒ¨åˆ†ï¼š**æœ¬é¡¹ç›®ä¸­åç«¯å…±æœ‰çº¦å…­ä¸ªæ¨¡å—ï¼šè§’è‰²ç‰¹å¾æå–ã€æ–‡ç”Ÿå›¾ã€å›¾ç”Ÿå›¾ã€å±€éƒ¨é‡ç»˜ã€è¶…åˆ†é‡æ„ã€è®­ç»ƒã€‚å…¶ä¸­ï¼Œè§’è‰²ç‰¹å¾æå–æœ¬è´¨ä¸Šå°±æ˜¯è®­ç»ƒæ¯ä¸€ä¸ªè§’è‰²çš„Loraæ¨¡å‹ã€‚æ–‡ç”Ÿå›¾ã€å›¾ç”Ÿå›¾ã€å±€éƒ¨é‡ç»˜è¿™ä¸‰éƒ¨åˆ†æ˜¯åº”ç”¨äº†ppdiffuserså†…ç½®çš„æ¥å£å®ç°ã€‚è¶…åˆ†é‡æ„æš‚æœªå®ç°ï¼ˆé¢„è®¡å°†realcu GANè¿ç§»åˆ°paadleä½¿ç”¨ï¼‰ã€‚è®­ç»ƒéƒ¨åˆ†åŒ…å«dreambooth loraã€style loraä¸¤éƒ¨åˆ†ã€‚

## 2ã€ç›®å½•ç»“æ„

é¡¹ç›®ç›®å½•æ–‡ä»¶ç»“æ„å¦‚ä¸‹ï¼š

![](https://ai-studio-static-online.cdn.bcebos.com/a683b75c29d24c13965f3b580b0a74e4fee541f36e2746718c5a5e4de34dbb63)


## 3ã€æ•°æ®ä¼ è¾“ï¼Œåœ¨æ¯ä¸ªæ–‡ä»¶ã€æ¨¡å—é—´çš„æµé€š

é¡¹ç›®æ–‡ä»¶ã€æ¨¡å—é—´çš„æ•°æ®æµå¦‚ä¸‹ï¼š

![](https://ai-studio-static-online.cdn.bcebos.com/9d87c6b7f781488ea3a3f2f2c028f356b8af4b98192b45e18846d734691c7663)


## 4ã€Gradioç•Œé¢UI

æœ¬é¡¹ç›®çš„ç•Œé¢ä»£ç å‡åœ¨webui.pyä¸­ï¼Œç»ç”±launch.gradio.pyå¯åŠ¨ã€‚

**ç•Œé¢UIå¦‚ä¸‹ï¼š**

ç•Œé¢å±•ç¤ºè§†é¢‘é“¾æ¥ï¼šã€äºŒæ¬¡å…ƒè§’è‰²é£æ ¼å®šåˆ¶é¡¹ç›®ç•Œé¢UIå±•ç¤ºã€‘ https://www.bilibili.com/video/BV1fu4y187CJ

**webuiä»£ç ä»‹ç»å¦‚ä¸‹ï¼š**

![](https://ai-studio-static-online.cdn.bcebos.com/5dd3702c368345a1aef88d40faeba2bfb4379817fd984c1d8c9b9d0a15e93b0c)


![](https://ai-studio-static-online.cdn.bcebos.com/1fabf55bc8a2425f809959a821fce97734e0129cd4bb48a59e6b24cb2354b650)



## 5ã€æ ¸å¿ƒæ¨¡å—utils

utils.pyæ–‡ä»¶æ˜¯æœ¬é¡¹ç›®ä¸­çš„ä¸€å¤§æ ¸å¿ƒæ¨¡å—ï¼Œå®ƒå°±åƒæ•´ä¸ªé¡¹ç›®çš„æ•°æ®ä¸­è½¬ç«™ã€‚

![](https://ai-studio-static-online.cdn.bcebos.com/38717706d837480bb48a96a59c15ff4c54b0515691734873ac58012d3a8e5a3e)


## 6ã€æ¨¡å—è¯¦è§£
### 6.1ã€è§’è‰²ç‰¹å¾æå–

![](https://ai-studio-static-online.cdn.bcebos.com/b17ab3bad27f405298d6840457b8b89e6c507e39028b469e89854f8f6a0b3273)


### 6.2ã€æ–‡ç”Ÿå›¾

![](https://ai-studio-static-online.cdn.bcebos.com/018f4a5e0be64f44801a1ace8320488fbd1ebb82d6784d628c375bf5e0c4e839)


### 6.3ã€å›¾ç”Ÿå›¾

![](https://ai-studio-static-online.cdn.bcebos.com/b9dce240baf64cb086de95ea546726c50f59f7b534ef47f4a0f2aff34e51344b)


### 6.4ã€å±€éƒ¨é‡ç»˜

![](https://ai-studio-static-online.cdn.bcebos.com/c57781f79a3c4170acf55b17fa14bffb9c389ad37a704e6fafcd2a746baea955)


### 6.5ã€è¶…åˆ†é‡æ„

**è¯¦è§utils.pyä»‹ç»**

### 6.6ã€è®­ç»ƒ

#### 6.6.1ã€Dreambooth Loraè®­ç»ƒ

**è¯¦è§utils.pyä»‹ç»**

#### 6.6.2ã€Loraè®­ç»ƒ

![](https://ai-studio-static-online.cdn.bcebos.com/cde349c7a6904c5d89e475732192e8387d846a101138404cba32d9ed43f1744c)



# ä¸‰ã€å…³äºæœ¬é¡¹ç›®

æœ¬é¡¹ç›®ä½¿ç”¨ppdiffusersä½œä¸ºåç«¯æ¨ç†ï¼Œgradioä½œä¸ºå‰ç«¯é¡µé¢ï¼Œæ·±åº¦å­¦ä¹ æ¡†æ¶æ˜¯paddleã€‚

## 1ã€ç›®å‰å¾…ä¿®å¤çš„å†…å®¹ï¼š
1. æœªåŠ å…¥ControlNet
1. è§’è‰²ç‰¹å¾æå–æ–¹æ¡ˆæœªç¡®å®šï¼Œæœ‰ä¸¤ä¸ªæ–¹æ¡ˆï¼Œ1ä¸ºæ¯ä¸ªè§’è‰²è®­ç»ƒä¸€ä¸ªloraï¼Œ2è®­ç»ƒä¸€ä¸ªé€šç”¨çš„Loraæå–è§’è‰²ç‰¹å¾ï¼ˆå·²é€‰æ‹©ç¬¬ä¸€ç§æ–¹æ¡ˆï¼‰
1. é€‰æ‹©è§’è‰²ã€é£æ ¼æ—¶æ˜¯å¦å±•ç¤ºå¯¹åº”å›¾ç‰‡
1. æ–‡ç”Ÿå›¾ã€å›¾ç”Ÿå›¾ã€å±€éƒ¨é‡ç»˜åˆ·æ–°æŒ‰é’®æœªå®šä¹‰é€‰é¡¹åˆ·æ–°å‡½æ•°ï¼ˆåˆ·æ–°æŒ‰é’®æš‚ä¸èƒ½ç”¨ï¼‰
1. ä¸Šä¼ å›¾ç‰‡åä¸èƒ½æœ‰ä¸­æ–‡ï¼ˆèƒ½ä¿å­˜åˆ°é¡¹ç›®æ–‡ä»¶å¤¹ä½†æ— æ³•åœ¨ç•Œé¢é¢„è§ˆï¼‰
1. è§’è‰²åéƒ¨åˆ†æš‚æ—¶ä¸æ”¯æŒä¸­æ–‡ï¼ˆè§’è‰²å±•æ¡†ä¼šæ˜¾ç¤ºï¼Ÿï¼Ÿï¼Ÿï¼‰
1. extractéƒ¨åˆ†ä¸­tmp_role_lora_stateè®¾ç½®Loraè®­ç»ƒå®Œæˆè¿›åº¦æ¡æç¤ºï¼ˆtmp_role_lora_stateä¸è®­ç»ƒè„šæœ¬å¼‚æ­¥è¿è¡Œï¼Œæš‚æ—¶ä¸èƒ½ä»£è¡¨è®­ç»ƒçŠ¶æ€ï¼‰
1. è®­ç»ƒè¿‡ç¨‹ä¸­æœªåŠ å…¥è®­ç»ƒåŠ¨æ€è¿›åº¦æ¡
1. tmp_style_loraéƒ¨åˆ†ä¸­tmp_style_lora_stateçš„é—®é¢˜åŒextractéƒ¨åˆ†
1. ä½¿ç”¨å¤šä¸ªLoraæ¨¡å‹ï¼ˆéæ¨¡å‹èåˆï¼‰æ–¹æ¡ˆï¼šå»ppiffusersä¸­æŠ„ä¸€ä»½è‡ªå®šä¹‰çš„Loraå±‚ï¼Œç„¶åæä¸ªå¤šLoraå±‚
1. å°†utilså­˜å‚¨å„é€‰é¡¹çš„å˜é‡ä¸­çš„å¸¸é‡è½¬ä¸ºä»æ–‡ä»¶è¯»å–ã€‚ï¼ˆä¸ºæ¯ä¸ªé€‰é¡¹åˆ›å»ºä¸€ä¸ªå­˜å‚¨å€¼çš„txtæ–‡ä»¶ï¼Œé¿å…ä¸‹æ¬¡è¿è¡Œç¯å¢ƒæ—¶å„é€‰é¡¹é‡ç½®åˆæ— æ³•å¯¼å…¥å·²æœ‰çš„å€¼ï¼‰,åˆ«å¿˜äº†å›¾ç‰‡ç”Ÿæˆè®¡æ•°(å“¨å…µ)
1. ppdiffusers/stable diffusionåŸºåº•æ¨¡å‹å¾®è°ƒè¿‡ç¨‹
## 2ã€å‚è€ƒé¡¹ç›®ï¼š
1. https://aistudio.baidu.com/projectdetail/5766153
1. https://aistudio.baidu.com/projectdetail/5964987
1. https://aistudio.baidu.com/projectdetail/5540885
1. https://aistudio.baidu.com/projectdetail/6790638
1. https://aistudio.baidu.com/projectdetail/6129764
1. https://aistudio.baidu.com/projectdetail/6926368
## 3ã€å…¶ä»–é¡¹ç›®ï¼šæš‚æ— 
